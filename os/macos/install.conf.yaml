---
- defaults:
    link:
      relink: true

- clean: ['~']

- create:
    - ~/.local/share/ollama
    - ~/Library/Application Support/Claude
    - ~/Library/LaunchAgents

- link:
    ~/.config/1Password: config/1Password
    ~/.config/karabiner: config/karabiner
    ~/.config/skhd: config/skhd
    ~/Library/LaunchAgents/me.kieranbamforth.1mcp.plist: os/macos/me.kieranbamforth.1mcp.plist
    ~/src: /Volumes/Source

- shell:
    - [make dependencies/brew]
    - [/opt/homebrew/bin/op inject -i ./config/zsh/.zshenv.secrets.tmpl -o ~/.zshenv.secrets]
    - [/opt/homebrew/bin/mise install]
    - [/opt/homebrew/bin/envsubst '$HOME' < ./config/claude-desktop/claude_desktop_config.json.tmpl > "$HOME/Library/Application Support/Claude/claude_desktop_config.json", Generating Claude Desktop config]
    - [launchctl load ~/Library/LaunchAgents/me.kieranbamforth.1mcp.plist]
    - [/opt/homebrew/bin/skhd --install-service]
    - [./os/macos/preferences.sh]
    - [./os/macos/startup-items.sh]
    - [./local/share/scripts/build-completions]
    - [./local/share/scripts/build-parsers ~/.local/share/nvim/site/pack/treesitter/start/nvim-treesitter/lockfile.json]
